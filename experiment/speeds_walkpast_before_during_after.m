speeds_spindle_WP = [0.518604444	0.634153929	0.484561054
0.5831531	0.646670272	0.444457379
0.606971572	0.526420697	0.97610129
0.802516169	0.556502068	0.578236161
0.310615719	0.353253369	0.362124815
0.920646784	0.815351494	0.710108949
0.309965004	0.482765305	0.543176055
0.259710918	0.31741321	0.590103546
0.321588696	0.443284064	0.377117845
0.345919504	0.38506088	0.365959397
0.786297434	0.444525046	0.323435557
0.852353193	0.75516731	0.566172971
0.741444163	0.545579847	0.509378627
0.305023425	0.338539589	0.298490689
0.182588834	0.215626398	0.218574685
1.410826265	0.622195404	0.752014203
0.604683552	0.362430475	0.366272788
0.513322976	0.361003844	0.672242254
0.664200942	0.539424544	0.650130324
1.037045995	0.777389208	1.182048305
1.452663421	1.035642924	2.192512511
1.719284571	0.857156324	1.22782554
0.393951567	0.356072475	0.688514696
0.536236339	0.466484549	0.806577632
0.764762716	0.628087189	0.643070104
0.797385331	1.981319455	1.801181825
0.853789343	1.191707383	1.122143565
0.47339829	0.325656713	0.348490385
1.659048566	1.238319359	0.80091036
0.704521037	0.577564071	0.549652839
1.064194379	1.474720158	1.172826955
0.796404579	0.994926531	0.785883022
0.148981772	0.265204677	0.272726103
0.433909163	0.379846434	0.508254434
0.515659709	0.622757062	0.492574494
0.618401198	0.623320545	0.36087221];
% speeds before, during, after in WP
np = size(speeds_spindle_WP,1);
Q = ones(np,1)*(1:1:3);
beeswarm_mark(Q(:),speeds_spindle_WP(:),'sort_style','rand','overlay_style','se');
set(gca,'XTick',1:3)
set(gca,'XTickLabel',{'Pre','During','Post'})
ylabel('Speed [\mum/min]');
set(gca,'FontSize',18)

%% Check differences
Zdiff = [speeds_spindle_WP(:,1)-speeds_spindle_WP(:,2) ; speeds_spindle_WP(:,2)-speeds_spindle_WP(:,3)];
Qdiff = [ones(np,1) ; 2*ones(np,1)];
figure
beeswarm_mark(Qdiff,Zdiff,'sort_style','rand','overlay_style','se');
hold on
xl = xlim;
plot(linspace(xl(1),xl(2),100),zeros(1,100),'k--')

% Do one-sample t-test to check if difference is different from zero:
% 
[h1,p1] = ttest(Zdiff(Qdiff==1));
[h2,p2] = ttest(Zdiff(Qdiff==2));

text(1,0,sprintf('p = %3.3g',p1));
text(2,0,sprintf('p = %3.3g',p2));